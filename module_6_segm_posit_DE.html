<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marktsegmentierung & Positionierung - Komplettmodul</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Crimson+Text:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #2c3e50;
            --bg-mid: #34495e;
            --text-primary: #f4f1e8;
            --accent-silver: #bdc3c7;
            --accent-light: #ecf0f1;
            --accent-green: #27ae60;
            --accent-red: #c0392b;
            --accent-blue: #3498db;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Crimson Text', serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, var(--bg-mid) 50%, var(--bg-dark) 100%);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-x: hidden;
            padding-bottom: 50px;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* --- UI FRAMEWORK --- */
        .container {
            max-width: 1000px;
            width: 95%;
            margin: 40px auto;
            position: relative;
        }

        .slide-panel {
            background: linear-gradient(135deg, rgba(44, 62, 80, 0.95), rgba(52, 73, 94, 0.95));
            border: 3px solid var(--accent-silver);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            padding: 5px;
            overflow: hidden;
        }

        header { text-align: center; margin-bottom: 30px; animation: fadeIn 1s ease-out; }

        .pediment {
            background: linear-gradient(135deg, var(--accent-silver) 0%, var(--accent-light) 100%);
            color: var(--bg-dark);
            text-align: center;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 10px 10px 0 0;
        }

        h1 { font-family: 'Cinzel', serif; font-weight: 700; font-size: 2.5rem; margin-bottom: 5px; text-shadow: 1px 1px 2px rgba(0,0,0,0.1); }
        h2 { font-family: 'Cinzel', serif; color: var(--bg-dark); font-size: 1.8rem; margin: 0; }
        .subtitle { font-family: 'Cinzel', serif; font-size: 1.4rem; color: var(--accent-light); margin-bottom: 5px; }
        .pediment .subtitle { color: var(--bg-mid); }
        .author-credit { font-family: 'Crimson Text', serif; font-size: 0.9rem; font-style: italic; opacity: 0.7; color: var(--accent-silver); }

        /* --- PROGRESS BAR --- */
        .progress-container { width: 100%; background-color: rgba(0,0,0,0.3); border-bottom: 1px solid var(--accent-silver); height: 8px; }
        .progress-bar { height: 100%; background: linear-gradient(90deg, var(--accent-silver), var(--accent-light)); width: 0%; transition: width 0.5s ease; }

        /* --- SECTIONS --- */
        .module { display: none; padding: 40px; min-height: 500px; animation: slideUp 0.6s ease-out; }
        .module.active { display: block; }
        .content-text { font-size: 1.4rem; line-height: 1.7; margin-bottom: 30px; text-align: center; max-width: 800px; margin-left: auto; margin-right: auto; }

        /* --- BUTTONS --- */
        .btn-container { display: flex; justify-content: center; gap: 20px; margin-top: 20px; }
        .btn {
            background: linear-gradient(135deg, var(--bg-mid), var(--bg-dark));
            color: var(--accent-light);
            border: 2px solid var(--accent-silver);
            padding: 12px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-family: 'Cinzel', serif;
            font-size: 1.1rem;
            transition: all 0.4s ease;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            display: inline-block;
        }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; border-color: #7f8c8d; box-shadow: none; }
        .btn:hover:not(:disabled) { background: linear-gradient(135deg, var(--accent-silver), var(--accent-light)); color: var(--bg-dark); transform: translateY(-3px) scale(1.05); box-shadow: 0 8px 20px rgba(0,0,0,0.4); }
        .btn-skip { background: transparent; border: 2px solid rgba(189, 195, 199, 0.5); color: var(--accent-silver); }
        .btn-skip:hover { background: rgba(236, 240, 241, 0.1); color: var(--accent-light); border-color: var(--accent-light); }
        
        /* Small button for next step in exercises */
        .btn-step {
            background: var(--accent-green);
            border: none;
            padding: 8px 20px;
            font-size: 1rem;
            margin-top: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .btn-step:hover { background: #2ecc71; color: white; transform: translateY(-2px); }

        /* --- GAME STYLES --- */
        /* Definition */
        .definition-box { background: rgba(236, 240, 241, 0.05); border: 1px solid rgba(189, 195, 199, 0.3); padding: 30px; border-radius: 10px; margin-bottom: 30px; font-size: 1.3rem; line-height: 2.2; text-align: justify; }
        .drop-blank { display: inline-block; min-width: 150px; height: 35px; border-bottom: 2px solid var(--accent-silver); margin: 0 5px; vertical-align: middle; text-align: center; background: rgba(0,0,0,0.2); border-radius: 4px; color: var(--accent-blue); font-weight: bold; font-family: 'Cinzel', serif; font-size: 1rem; line-height: 35px; padding: 0 10px; }
        .drop-blank.filled { border-bottom: 2px solid var(--accent-green); background: rgba(39, 174, 96, 0.1); }
        .word-bank { display: flex; justify-content: center; flex-wrap: wrap; gap: 15px; margin-top: 20px; }
        .word-chip { background: linear-gradient(135deg, var(--accent-light), var(--accent-silver)); color: var(--bg-dark); padding: 10px 20px; border-radius: 20px; font-weight: bold; cursor: grab; user-select: none; box-shadow: 0 3px 8px rgba(0,0,0,0.3); font-family: 'Cinzel', serif; }
        .word-chip:active { cursor: grabbing; transform: scale(0.95); }
        .word-chip.used { opacity: 0.3; cursor: default; pointer-events: none; }

        /* Sorting (Buckets) */
        .sorting-arena { display: flex; gap: 20px; justify-content: space-around; flex-wrap: wrap; margin-top: 30px; }
        .bucket { width: 23%; min-width: 180px; min-height: 250px; background: rgba(236, 240, 241, 0.1); border: 2px dashed var(--accent-silver); border-radius: 10px; padding: 20px; text-align: center; transition: all 0.3s; }
        .bucket.drag-over { background: rgba(236, 240, 241, 0.25); border-color: #fff; transform: scale(1.02); }
        .bucket h3 { font-family: 'Cinzel', serif; color: var(--accent-silver); margin-bottom: 10px; font-size: 1.0rem; border-bottom: 1px solid rgba(189, 195, 199, 0.3); padding-bottom: 10px; }
        .card-stack { width: 100%; display: flex; justify-content: center; margin-bottom: 30px; height: 120px; }
        .card { background: linear-gradient(135deg, var(--accent-light), var(--accent-silver)); color: var(--bg-dark); padding: 15px 15px; border-radius: 8px; font-weight: bold; font-size: 1.0rem; cursor: grab; box-shadow: 0 5px 15px rgba(0,0,0,0.3); user-select: none; position: absolute; z-index: 50; width: 220px; text-align: center; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .card:active { cursor: grabbing; }

        /* Sequencing */
        .sequence-container { display: flex; flex-direction: column; gap: 15px; max-width: 800px; margin: 0 auto; }
        .sequence-slot { background: rgba(236, 240, 241, 0.05); border: 1px solid rgba(189, 195, 199, 0.3); padding: 15px; border-radius: 8px; display: flex; align-items: center; gap: 15px; }
        .step-number { font-family: 'Cinzel', serif; font-size: 1.8rem; color: var(--accent-silver); width: 50px; text-align: center; font-weight: bold; }
        .draggable-step { flex-grow: 1; background: linear-gradient(135deg, var(--bg-mid), var(--bg-dark)); padding: 18px; border-radius: 6px; cursor: grab; border: 1px solid var(--accent-silver); display: flex; justify-content: space-between; align-items: center; color: var(--accent-light); font-size: 1.1rem; box-shadow: 0 2px 5px rgba(0,0,0,0.2); transition: transform 0.2s; }
        .draggable-step:active { cursor: grabbing; transform: scale(0.98); }

        /* Mixer / Scenario Options */
        .mixer-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 25px; margin-top: 30px; }
        .mixer-card { background: rgba(236, 240, 241, 0.1); padding: 25px; border-radius: 10px; text-align: center; border: 2px solid transparent; cursor: pointer; transition: all 0.3s; }
        .mixer-card:hover { background: rgba(236, 240, 241, 0.15); transform: translateY(-5px); box-shadow: 0 8px 25px rgba(0,0,0,0.2); }
        .mixer-card.selected { border-color: var(--accent-silver); background: rgba(236, 240, 241, 0.2); box-shadow: 0 0 15px rgba(189, 195, 199, 0.3); }
        .mixer-icon { font-size: 2.5rem; margin-bottom: 15px; display: block; }
        
        /* Contact/Strategy Scenario */
        .scenario-box { background: rgba(236, 240, 241, 0.1); padding: 20px; border-radius: 10px; margin-bottom: 25px; text-align: center; font-size: 1.3rem; border: 1px solid var(--accent-silver); }
        .options-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; }
        .option-card { background: rgba(44, 62, 80, 0.8); border: 2px solid var(--accent-silver); padding: 15px; border-radius: 8px; cursor: pointer; text-align: center; transition: all 0.3s; display: flex; align-items: center; justify-content: center; height: 100%; min-height: 80px; }
        .option-card:hover { background: var(--accent-light); color: var(--bg-dark); transform: translateY(-3px); }

        /* Quiz */
        .quiz-option { background: rgba(255, 255, 255, 0.05); margin: 10px 0; padding: 15px; border-radius: 8px; cursor: pointer; border: 1px solid transparent; transition: all 0.2s; text-align: left; }
        .quiz-option:hover { background: rgba(255, 255, 255, 0.1); border-color: var(--accent-silver); }
        .quiz-option.selected-correct { background: rgba(39, 174, 96, 0.3); border-color: var(--accent-green); }
        .quiz-option.selected-wrong { background: rgba(192, 57, 43, 0.3); border-color: var(--accent-red); }

        /* Feedback */
        .feedback-area { min-height: 60px; margin-top: 25px; text-align: center; font-weight: bold; font-size: 1.2rem; padding: 10px; border-radius: 5px; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .success { color: var(--accent-green); margin-bottom: 10px; display: block; }
        .error { color: var(--accent-red); margin-bottom: 10px; display: block; }
        .explanation-text { font-size: 1rem; color: var(--accent-silver); font-weight: normal; margin-bottom: 10px; display: block; max-width: 800px; }
        .hidden { display: none; }
        
        .citation { font-size: 0.9rem; color: var(--accent-silver); opacity: 0.7; margin-top: 10px; font-style: italic; }

        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        @media (max-width: 768px) {
            h1 { font-size: 2rem; }
            .module { padding: 25px 15px; }
            .sorting-arena { flex-direction: column; align-items: center; }
            .bucket { width: 90%; }
            .options-grid, .mixer-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <header>
        <h1 style="color: var(--accent-silver);">Grundlagen des Marketing</h1>
        <div class="subtitle">Modul 6: Marktsegmentierung und -positionierung</div>
        <div class="author-credit">erstellt von Matthias Glaser, PhD - mit Gemini 3/Claude Sonnet 4.5 (entsprechende Einschr√§nkungen gelten)</div>
    </header>

    <div class="container slide-panel">
        <div class="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
        </div>

        <!-- MODULE 0: INTRO -->
        <div class="module active" id="mod-intro">
            <div class="pediment">
                <h2>√úbersicht</h2>
                <div class="subtitle">Was Sie erwartet</div>
            </div>
            <div class="content-text">
                <p>Dieses Modul behandelt die Kernprozesse der kundenzentrierten Marketingstrategie:</p>
                <ul style="text-align: left; max-width: 600px; margin: 0 auto; line-height: 1.6;">
                    <li>Definition der Kernbegriffe (Segmentierung, Targeting, etc.)</li>
                    <li>Kriterien der Kundensegmentierung</li>
                    <li>Der Prozess der Zielgruppenbestimmung</li>
                    <li>Marktabdeckungsstrategien</li>
                    <li>Anforderungen an Segmente</li>
                    <li>Nutzenversprechen & Positionierung</li>
                </ul>
            </div>
            <div class="btn-container">
                <button class="btn" onclick="nextModule(1)">Starten</button>
            </div>
        </div>

        <!-- MODULE 1: DEFINITION -->
        <div class="module" id="mod-def">
            <div class="pediment">
                <h2>1. Kernbegriffe</h2>
                <div class="subtitle">Die vier Schritte</div>
            </div>
            <div class="content-text">
                <p>Vervollst√§ndigen Sie die Definitionen der vier Hauptschritte (cf. Kotler et al. 2019: 336).</p>
            </div>
            <div class="definition-box">
                Der Prozess beginnt mit der 
                <span class="drop-blank" data-target="Segmentierung" ondragover="allowDropDef(event)" ondrop="dropDef(event)"></span>, 
                d.h. der Unterteilung des Marktes in K√§ufergruppen. Darauf folgt das 
                <span class="drop-blank" data-target="Targeting" ondragover="allowDropDef(event)" ondrop="dropDef(event)"></span> 
                (Auswahl der Zielm√§rkte). Anschlie√üend legt man die 
                <span class="drop-blank" data-target="Differenzierung" ondragover="allowDropDef(event)" ondrop="dropDef(event)"></span> 
                fest, um ein √ºberlegenes Angebot zu schaffen, und bestimmt die 
                <span class="drop-blank" data-target="Positionierung" ondragover="allowDropDef(event)" ondrop="dropDef(event)"></span> 
                des Angebots im Kopf der Kunden.
            </div>
            <div class="word-bank" id="definition-words"></div>
            <div class="feedback-area" id="feedback-def"></div>
            <div class="btn-container">
                <button class="btn btn-skip" onclick="skipAndNext(2)">√úberspringen</button>
                <button class="btn" id="btn-next-def" disabled onclick="completeAndNext(2)">Weiter</button>
            </div>
        </div>

        <!-- MODULE 2: CRITERIA (Sorting) -->
        <div class="module" id="mod-crit">
            <div class="pediment">
                <h2>2. Segmentierungskriterien</h2>
                <div class="subtitle">Geografisch, Demografisch, Psychografisch, Verhaltensorientiert</div>
            </div>
            <div class="content-text">
                <p>Ordnen Sie die Kriterien der korrekten Kategorie zu (cf. Kotler et al. 2019: 337-338).</p>
            </div>
            <div class="card-stack" id="stack-crit"></div>
            <div class="sorting-arena">
                <div class="bucket" data-type="geo" ondragover="allowDropObj(event)" ondrop="dropObj(event)">
                    <h3>Geografisch</h3>
                </div>
                <div class="bucket" data-type="demo" ondragover="allowDropObj(event)" ondrop="dropObj(event)">
                    <h3>Demografisch</h3>
                </div>
                <div class="bucket" data-type="psycho" ondragover="allowDropObj(event)" ondrop="dropObj(event)">
                    <h3>Psychografisch</h3>
                </div>
                <div class="bucket" data-type="verhalten" ondragover="allowDropObj(event)" ondrop="dropObj(event)">
                    <h3>Verhalten</h3>
                </div>
            </div>
            <div class="feedback-area" id="feedback-crit"></div>
            <div class="btn-container">
                <button class="btn btn-skip" onclick="skipAndNext(3)">√úberspringen</button>
                <button class="btn" id="btn-next-crit" style="display:none;" onclick="completeAndNext(3)">Weiter</button>
            </div>
        </div>

        <!-- MODULE 3: PROCESS (Sequence) -->
        <div class="module" id="mod-proc">
            <div class="pediment">
                <h2>3. Der Prozess</h2>
                <div class="subtitle">Richtige Reihenfolge</div>
            </div>
            <div class="content-text">
                <p>Bringen Sie die vier Schritte der kundenorientierten Marketingstrategie in die logische Reihenfolge (cf. Kotler et al. 2019: 336, Abb. 7.2).</p>
            </div>
            <div class="sequence-container" id="list-proc"></div>
            <div class="feedback-area" id="feedback-proc"></div>
            <div class="btn-container">
                <button class="btn btn-skip" onclick="skipAndNext(4)">√úberspringen</button>
                <button class="btn" onclick="checkProcessOrder()">Pr√ºfen</button>
                <button class="btn" id="btn-next-proc" style="display:none;" onclick="completeAndNext(4)">Weiter</button>
            </div>
        </div>

        <!-- MODULE 4: STRATEGIES (Scenario Mixer) -->
        <div class="module" id="mod-strat">
            <div class="pediment">
                <h2>4. Marktabdeckungsstrategien</h2>
                <div class="subtitle">Massen-, Zielgruppen-, Nischen- oder Mikromarketing?</div>
            </div>
            <div class="content-text">
                <p>Entscheiden Sie anhand der Beispiele, welche Strategie verfolgt wird (cf. Kotler et al. 2019: 352, Abb. 7.3).</p>
            </div>
            <div id="strat-game">
                <!-- Steps will be generated dynamically -->
            </div>
            <div class="feedback-area" id="feedback-strat"></div>
            <div class="btn-container">
                <button class="btn btn-skip" onclick="skipAndNext(5)">√úberspringen</button>
                <button class="btn" id="btn-next-strat" style="display:none;" onclick="completeAndNext(5)">Weiter</button>
            </div>
        </div>

        <!-- MODULE 5: REQUIREMENTS (Scenario) -->
        <div class="module" id="mod-req">
            <div class="pediment">
                <h2>5. Anforderungen an Segmente</h2>
                <div class="subtitle">Messbar, Zug√§nglich, Bedeutend?</div>
            </div>
            <div class="content-text">
                <p>Welche Anforderung an eine effiziente Segmentierung wird hier NICHT erf√ºllt? (cf. Kotler et al. 2019: 349-350).</p>
            </div>
            <div id="req-game-container"></div>
            <div class="feedback-area" id="feedback-req"></div>
            <div class="btn-container">
                <button class="btn btn-skip" onclick="skipAndNext(6)">√úberspringen</button>
                <button class="btn" id="btn-next-req" style="display:none;" onclick="completeAndNext(6)">Weiter</button>
            </div>
        </div>

        <!-- MODULE 6: VALUE PROPOSITION (Matrix Quiz) -->
        <div class="module" id="mod-val">
            <div class="pediment">
                <h2>6. Nutzenversprechen</h2>
                <div class="subtitle">Mehr f√ºr Mehr oder Weniger f√ºr Weniger?</div>
            </div>
            <div class="content-text">
                <p>Ordnen Sie das Beispiel der korrekten Preis-Leistungs-Strategie zu (cf. Kotler et al. 2019: 373, Abb. 7.6).</p>
            </div>
            <div id="quiz-container"></div>
            <div class="feedback-area" id="feedback-val"></div>
            <div class="btn-container">
                <button class="btn btn-skip" onclick="skipAndNext(7)">√úberspringen</button>
                <button class="btn" id="btn-next-val" style="display:none;" onclick="completeAndNext(7)">Abschlie√üen</button>
            </div>
        </div>

        <!-- FINAL -->
        <div class="module" id="mod-final" style="text-align: center;">
            <div class="pediment" id="final-heading">
                <h2>Abschluss</h2>
            </div>
            <div id="final-content">
                <!-- Content will be generated by JavaScript based on completion status -->
            </div>
            <button class="btn" onclick="location.reload()">Neustart</button>
        </div>

    </div>

    <script>
        // --- GLOBAL STATE ---
        let currentModule = 0;
        let dragSrcEl = null; // Shared drag source
        let completedModules = new Set(); // Track which modules were actually completed (not skipped)

        document.addEventListener('DOMContentLoaded', () => {
            updateProgress();
            initDefinitionGame(); // Pre-load first game
        });

        function nextModule(n) {
            document.querySelectorAll('.module').forEach(m => m.classList.remove('active'));
            // Mapping numbers to IDs
            let id = 'mod-intro';
            if(n===1) id='mod-def';
            if(n===2) id='mod-crit';
            if(n===3) id='mod-proc';
            if(n===4) id='mod-strat';
            if(n===5) id='mod-req';
            if(n===6) id='mod-val';
            if(n===7) {
                id='mod-final';
                updateFinalModule();
            }

            document.getElementById(id).classList.add('active');
            currentModule = n;
            updateProgress();

            // Init games on demand
            if(n===2) initCritGame();
            if(n===3) initProcessGame();
            if(n===4) initStratGame();
            if(n===5) initReqGame();
            if(n===6) initValGame();
        }

        function skipAndNext(n) { nextModule(n); }
        
        function completeAndNext(n) {
            // Mark current module as completed
            completedModules.add(currentModule);
            nextModule(n);
        }

        function updateProgress() {
            // Approx percentages for 7 steps (0-6)
            const p = Math.round((currentModule / 7) * 100);
            document.getElementById('progress-bar').style.width = `${p}%`;
        }
        
        function updateFinalModule() {
            const finalContent = document.getElementById('final-content');
            const totalExercises = 6; // Modules 1-6 are exercises
            
            if (completedModules.size === totalExercises) {
                finalContent.innerHTML = `
                    <div style="font-size: 4rem; color: var(--accent-green); margin: 20px;">‚úì</div>
                    <div class="content-text">
                        <p><strong>Herzlichen Gl√ºckwunsch!</strong></p>
                        <p>Sie haben alle √úbungen zu Marktsegmentierung und Positionierung erfolgreich abgeschlossen.</p>
                        <p>Sie verstehen nun, wie Unternehmen Zielgruppen ausw√§hlen und sich vom Wettbewerb differenzieren.</p>
                    </div>
                `;
            } else {
                const skipped = totalExercises - completedModules.size;
                finalContent.innerHTML = `
                    <div style="font-size: 4rem; color: var(--accent-red); margin: 20px;">‚ö†</div>
                    <div class="content-text">
                        <p><strong>Modul durchlaufen</strong></p>
                        <p>Sie haben ${skipped} ${skipped === 1 ? '√úbung' : '√úbungen'} √ºbersprungen.</p>
                        <p style="color: var(--accent-red); font-weight: bold;">F√ºr ein vollst√§ndiges Verst√§ndnis ist es wichtig, alle √úbungen durchzuf√ºhren.</p>
                        <p>Bitte starten Sie das Modul neu.</p>
                    </div>
                `;
            }
        }

        // --- SHARED DRAG HANDLERS (Generic) ---
        function dragStart(e) {
            dragSrcEl = this;
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/html', this.innerHTML);
            this.style.opacity = '0.4';
        }
        function dragOver(e) { if (e.preventDefault) e.preventDefault(); return false; }
        function dragEnter(e) { this.classList.add('over'); }
        function dragDropGeneric(e) {
            if (e.stopPropagation) e.stopPropagation();
            if (dragSrcEl !== this) {
                const tempHTML = this.innerHTML;
                const tempId = this.dataset.id;
                this.innerHTML = dragSrcEl.innerHTML;
                this.dataset.id = dragSrcEl.dataset.id;
                dragSrcEl.innerHTML = tempHTML;
                dragSrcEl.dataset.id = tempId;
            }
            dragSrcEl.style.opacity = '1';
            return false;
        }


        // --- 1. DEFINITION GAME ---
        const defWords = ["Segmentierung", "Targeting", "Differenzierung", "Positionierung"];
        let placedWordsDef = 0;
        function initDefinitionGame() {
            const container = document.getElementById('definition-words');
            container.innerHTML = '';
            [...defWords].sort(() => Math.random() - 0.5).forEach(word => {
                const chip = document.createElement('div');
                chip.className = 'word-chip';
                chip.draggable = true;
                chip.textContent = word;
                chip.dataset.word = word;
                chip.addEventListener('dragstart', (e) => {
                    e.dataTransfer.setData("text", e.target.dataset.word);
                });
                container.appendChild(chip);
            });
        }
        function allowDropDef(ev) { ev.preventDefault(); ev.currentTarget.classList.add('over'); }
        function dropDef(ev) {
            ev.preventDefault();
            ev.currentTarget.classList.remove('over');
            const word = ev.dataTransfer.getData("text");
            const target = ev.currentTarget.dataset.target;
            if (ev.currentTarget.textContent.trim() !== "") return; 
            if (word === target) {
                ev.currentTarget.textContent = word;
                ev.currentTarget.classList.add('filled');
                placedWordsDef++;
                document.querySelectorAll('.word-chip').forEach(c => {
                    if(c.dataset.word === word && !c.classList.contains('used')) c.classList.add('used');
                });
                if(placedWordsDef === defWords.length) {
                    document.getElementById('feedback-def').innerHTML = "<span class='success'>Richtig!</span>";
                    document.getElementById('btn-next-def').disabled = false;
                }
            } else {
                const fb = document.getElementById('feedback-def');
                fb.innerHTML = "<span class='error'>Falsch.</span>";
                setTimeout(()=>fb.innerHTML="", 1000);
            }
        }

        // --- 2. CRITERIA SORTING ---
        const critItems = [
            { id: 1, text: "Bundesland / Region", type: "geo", icon: "üó∫Ô∏è" },
            { id: 2, text: "Lebensalter", type: "demo", icon: "üéÇ" },
            { id: 3, text: "Soziale Klasse", type: "psycho", icon: "üé©" },
            { id: 4, text: "Kaufanlass", type: "verhalten", icon: "üìÖ" },
            { id: 5, text: "Einkommen", type: "demo", icon: "üí∞" },
            { id: 6, text: "Lebensstil (Lifestyle)", type: "psycho", icon: "üßò" },
            { id: 7, text: "Markentreue", type: "verhalten", icon: "‚ù§Ô∏è" },
            { id: 8, text: "Klima", type: "geo", icon: "‚òÄÔ∏è" }
        ];
        let curCritIdx = 0;
        function initCritGame() {
            curCritIdx = 0;
            loadCritCard();
        }
        function loadCritCard() {
            const stack = document.getElementById('stack-crit');
            stack.innerHTML = '';
            if(curCritIdx >= critItems.length) {
                document.getElementById('feedback-crit').innerHTML = "<span class='success'>Erledigt!</span>";
                document.getElementById('btn-next-crit').style.display = 'inline-block';
                return;
            }
            const item = critItems[curCritIdx];
            const card = document.createElement('div');
            card.className = 'card';
            card.draggable = true;
            card.innerHTML = `<span>${item.icon}</span> ${item.text}`;
            card.dataset.type = item.type;
            card.addEventListener('dragstart', (e) => e.dataTransfer.setData("text", item.type));
            stack.appendChild(card);
        }
        function allowDropObj(ev) { ev.preventDefault(); ev.currentTarget.classList.add('drag-over'); }
        function dropObj(ev) {
            ev.preventDefault();
            ev.currentTarget.classList.remove('drag-over');
            const type = ev.dataTransfer.getData("text");
            if(type === ev.currentTarget.dataset.type) {
                document.getElementById('stack-crit').innerHTML = ''; // Hide card visually
                curCritIdx++;
                if(curCritIdx >= critItems.length) {
                    loadCritCard(); // This triggers the done state
                } else {
                    document.getElementById('feedback-crit').innerHTML = "<span class='success'>Richtig!</span><br><button class='btn btn-step' onclick='nextCritCard()'>N√§chste Karte</button>";
                }
            } else {
                document.getElementById('feedback-crit').innerHTML = "<span class='error'>Falsch.</span>";
            }
        }
        function nextCritCard() {
            document.getElementById('feedback-crit').innerHTML = "";
            loadCritCard();
        }

        // --- 3. PROCESS SEQUENCING ---
        const procSteps = [
            { id: 1, text: "Segmentierung: Aufteilung des Gesamtmarkts" },
            { id: 2, text: "Targeting: Auswahl der Zielsegmente" },
            { id: 3, text: "Differenzierung: Schaffung von Kundenwert" },
            { id: 4, text: "Positionierung: Platzierung im Kopf der Kunden" }
        ];
        function initProcessGame() {
            const container = document.getElementById('list-proc');
            container.innerHTML = '';
            // Shuffle
            [...procSteps].sort(() => Math.random() - 0.5).forEach((step, i) => {
                const el = document.createElement('div');
                el.className = 'draggable-step';
                el.draggable = true;
                el.innerHTML = `<span>${step.text}</span>`;
                el.dataset.id = step.id;
                el.addEventListener('dragstart', dragStart);
                el.addEventListener('dragover', dragOver);
                el.addEventListener('drop', dragDropGeneric);
                el.addEventListener('dragenter', dragEnter);
                
                const slot = document.createElement('div');
                slot.className = 'sequence-slot';
                slot.innerHTML = `<div class='step-number'>${i + 1}.</div>`;
                slot.appendChild(el);
                container.appendChild(slot);
            });
        }
        function checkProcessOrder() {
            const steps = document.querySelectorAll('#list-proc .draggable-step');
            let correct = 0;
            steps.forEach((s, i) => { if(parseInt(s.dataset.id) === i+1) correct++; });
            if(correct === 4) {
                document.getElementById('feedback-proc').innerHTML = "<span class='success'>Korrekt!</span>";
                // Hide check button, show next button
                document.querySelector('#mod-proc .btn-container button[onclick*=\"checkProcessOrder\"]').style.display = 'none';
                document.getElementById('btn-next-proc').style.display = 'inline-block';
            } else {
                document.getElementById('feedback-proc').innerHTML = "<span class='error'>Die Reihenfolge stimmt nicht.</span>";
            }
        }

        // --- 4. STRATEGIES (Scenario Mixer) ---
        const stratScenarios = [
            {
                title: "Einheitsangebot",
                desc: "Ein Unternehmen bietet ein einziges Produkt f√ºr den gesamten Markt an (z.B. Salz oder Stahl).",
                options: [
                    { id: 'a', text: "Massenmarketing", icon: "üè≠" },
                    { id: 'b', text: "Zielgruppenmarketing", icon: "üéØ" }
                ],
                correct: 'a',
                explanation: "Massenmarketing (undifferenziert) ignoriert Segmentunterschiede."
            },
            {
                title: "Verschiedene Produkte",
                desc: "Ein Autohersteller bietet Kleinwagen, Familienkombis und Luxuslimousinen f√ºr verschiedene Segmente an.",
                options: [
                    { id: 'a', text: "Massenmarketing", icon: "üè≠" },
                    { id: 'b', text: "Zielgruppenmarketing", icon: "üéØ" }
                ],
                correct: 'b',
                explanation: "Zielgruppenmarketing (differenziert) spricht mehrere Segmente mit jeweils passenden Angeboten an."
            },
            {
                title: "Fokus auf Spezialmarkt",
                desc: "Ein Unternehmen verkauft ausschlie√ülich Ausr√ºstung f√ºr Tiefseetaucher.",
                options: [
                    { id: 'a', text: "Nischenmarketing", icon: "üîç" },
                    { id: 'b', text: "Mikromarketing", icon: "üî¨" }
                ],
                correct: 'a',
                explanation: "Nischenmarketing (konzentriert) fokussiert sich auf einen kleinen Teilmarkt."
            },
            {
                title: "Ma√ügeschneidert",
                desc: "Ein Schneider fertigt Anz√ºge exakt nach den Ma√üen und W√ºnschen jedes einzelnen Kunden.",
                options: [
                    { id: 'a', text: "Nischenmarketing", icon: "üîç" },
                    { id: 'b', text: "Mikromarketing", icon: "üî¨" }
                ],
                correct: 'b',
                explanation: "Mikromarketing (individuell) passt Produkte an einzelne Personen oder lokale Standorte an."
            }
        ];
        
        function initStratGame() {
            const container = document.getElementById('strat-game');
            container.innerHTML = '';
            stratScenarios.forEach((scen, idx) => {
                const stepDiv = document.createElement('div');
                stepDiv.className = `mix-step ${idx === 0 ? '' : 'hidden'}`;
                stepDiv.id = `strat-step-${idx + 1}`;
                stepDiv.innerHTML = `
                    <h3 style="text-align:center; color: var(--accent-silver); margin-bottom: 5px;">${scen.title}</h3>
                    <p style="text-align:center; margin-bottom:15px; font-style:italic;">${scen.desc}</p>
                    <div class="mixer-grid">
                        <div class="mixer-card" onclick="selectStrat(${idx + 1}, '${scen.options[0].id}', this)">
                            <span class="mixer-icon">${scen.options[0].icon}</span>
                            <h3>${scen.options[0].text}</h3>
                        </div>
                        <div class="mixer-card" onclick="selectStrat(${idx + 1}, '${scen.options[1].id}', this)">
                            <span class="mixer-icon">${scen.options[1].icon}</span>
                            <h3>${scen.options[1].text}</h3>
                        </div>
                    </div>
                `;
                container.appendChild(stepDiv);
            });
        }

        function selectStrat(stepIdx, choice, el) {
            el.parentElement.querySelectorAll('.mixer-card').forEach(c => c.classList.remove('selected'));
            el.classList.add('selected');
            
            const scen = stratScenarios[stepIdx - 1];
            const fb = document.getElementById('feedback-strat');
            
            if(choice === scen.correct) {
                fb.innerHTML = `<span class='success'>Richtig!</span><span class='explanation-text'>${scen.explanation}</span>`;
                if(stepIdx < stratScenarios.length) {
                    fb.innerHTML += `<button class="btn btn-step" onclick="nextStratStep(${stepIdx})">N√§chstes Szenario</button>`;
                } else {
                    document.getElementById('btn-next-strat').style.display = 'inline-block';
                }
            } else {
                fb.innerHTML = `<span class='error'>Nicht ganz.</span><span class='explanation-text'>${scen.explanation}</span>`;
            }
        }

        function nextStratStep(currentStepIdx) {
            document.getElementById('feedback-strat').innerHTML = "";
            const current = document.getElementById(`strat-step-${currentStepIdx}`);
            const next = document.getElementById(`strat-step-${currentStepIdx + 1}`);
            if(next) {
                current.classList.add('hidden');
                next.classList.remove('hidden');
            }
        }

        // --- 5. REQUIREMENTS SCENARIO ---
        const reqScenarios = [
            { 
                t: "Man wei√ü nicht, wie viele Linksh√§nder es in der Region gibt, da keine Daten vorliegen.", 
                opts: [{t:"Messbarkeit",c:true}, {t:"Bedeutung",c:false}],
                expl: "Messbarkeit: Die Gr√∂√üe und Kaufkraft der Segmente muss messbar sein."
            },
            { 
                t: "Die Zielgruppe wohnt in einer abgeschotteten Community ohne Internet und Medienzugang.", 
                opts: [{t:"Zug√§nglichkeit",c:true}, {t:"Differenzierbarkeit",c:false}],
                expl: "Zug√§nglichkeit: Die Segmente m√ºssen kommunikativ und physisch erreichbar sein."
            },
            { 
                t: "Ein Autohersteller plant ein Modell f√ºr Menschen unter 1,40m K√∂rpergr√∂√üe. Die Gruppe ist zu klein, um die Entwicklungskosten zu decken.", 
                opts: [{t:"Bedeutung (Substanz)",c:true}, {t:"Messbarkeit",c:false}],
                expl: "Bedeutung: Das Segment muss gro√ü/profitabel genug sein, um ein eigenes Programm zu lohnen."
            },
            { 
                t: "M√§nner und Frauen reagieren identisch auf Werbung f√ºr Softdrinks. Es macht keinen Sinn, sie getrennt anzusprechen.", 
                opts: [{t:"Differenzierbarkeit",c:true}, {t:"Zug√§nglichkeit",c:false}],
                expl: "Differenzierbarkeit: Segmente m√ºssen unterschiedlich auf Marketing-Mix-Elemente reagieren."
            },
            { 
                t: "Eine kleine Airline identifiziert 7 Segmente, hat aber nur Budget f√ºr ein einziges Marketingprogramm.", 
                opts: [{t:"Umsetzbarkeit",c:true}, {t:"Messbarkeit",c:false}],
                expl: "Umsetzbarkeit: Das Unternehmen muss die Ressourcen haben, um die Segmente zu bedienen."
            }
        ];
        let curReqIdx = 0;
        function initReqGame() {
            curReqIdx = 0;
            showReqScenario();
        }
        function showReqScenario() {
            const container = document.getElementById('req-game-container');
            const scen = reqScenarios[curReqIdx];
            if(!scen) {
                document.getElementById('feedback-req').innerHTML = "<span class='success'>Alle gel√∂st!</span>";
                document.getElementById('btn-next-req').style.display = 'inline-block';
                container.innerHTML = "";
                return;
            }
            container.innerHTML = `
                <div class="scenario-box">Szenario ${curReqIdx+1}:<br><strong>${scen.t}</strong></div>
                <div class="content-text" style="font-size:1rem; margin-bottom:10px;">Welches Kriterium ist verletzt?</div>
                <div class="options-grid">
                    <div class="option-card" onclick="checkReq(0)">${scen.opts[0].t}</div>
                    <div class="option-card" onclick="checkReq(1)">${scen.opts[1].t}</div>
                </div>
            `;
        }
        function checkReq(optIdx) {
            const scen = reqScenarios[curReqIdx];
            const fb = document.getElementById('feedback-req');
            if(scen.opts[optIdx].c) {
                fb.innerHTML = `<span class='success'>Richtig!</span><span class='explanation-text'>${scen.expl}</span>`;
                if(curReqIdx < reqScenarios.length - 1) {
                    fb.innerHTML += `<button class="btn btn-step" onclick="nextReqStep()">N√§chstes Szenario</button>`;
                } else {
                     fb.innerHTML += `<button class="btn btn-step" onclick="nextReqStep()">Fertigstellen</button>`;
                }
            } else {
                fb.innerHTML = `<span class='error'>Falsch.</span><span class='explanation-text'>${scen.expl}</span>`;
            }
        }
        function nextReqStep() {
            document.getElementById('feedback-req').innerHTML = "";
            curReqIdx++;
            showReqScenario();
        }

        // --- 6. VALUE PROPOSITION QUIZ ---
        const valQs = [
            { q: "Mercedes-Benz: H√∂chste Qualit√§t, Prestige, hoher Preis.", opts: ["Mehr f√ºr mehr", "Mehr zum selben Preis", "Weniger f√ºr weniger"], c: 0, expl: "'Mehr f√ºr mehr': √úberlegenes Produkt zu h√∂herem Preis (z.B. Luxusg√ºter)." },
            { q: "Lexus bei Einf√ºhrung: Mercedes-Qualit√§t, aber g√ºnstiger.", opts: ["Mehr f√ºr mehr", "Mehr f√ºr weniger", "Das Gleiche f√ºr weniger"], c: 2, expl: "'Das Gleiche f√ºr weniger': √Ñhnliche Qualit√§t wie Markenf√ºhrer, aber preiswerter (Angriffsstrategie)." },
            { q: "Ryanair/EasyJet: Kein Essen, kein Gep√§ck, sehr g√ºnstiger Preis.", opts: ["Weniger f√ºr weniger", "Mehr f√ºr mehr", "Das Gleiche f√ºr weniger"], c: 0, expl: "'Weniger f√ºr weniger': Bewusster Verzicht auf Leistung/Service f√ºr einen minimalen Preis." },
            { q: "Baumarkt mit Tiefpreisgarantie auf Markenartikel.", opts: ["Das Gleiche f√ºr weniger", "Mehr f√ºr mehr", "Weniger f√ºr mehr"], c: 0, expl: "'Das Gleiche f√ºr weniger': Identische Markenprodukte g√ºnstiger anbieten (z.B. durch Discounter-Macht)." },
            { q: "Das 'beste Angebot': Beste Leistung zum niedrigsten Preis (langfristig schwer haltbar).", opts: ["Mehr f√ºr weniger", "Mehr f√ºr mehr", "Weniger f√ºr weniger"], c: 0, expl: "'Mehr f√ºr weniger' ist das attraktivste Angebot, aber oft √∂konomisch schwer durchzuhalten." }
        ];
        let curValIdx = 0;
        function initValGame() {
            curValIdx = 0;
            showValQuiz();
        }
        function showValQuiz() {
            const container = document.getElementById('quiz-container');
            const q = valQs[curValIdx];
            if(!q) {
                document.getElementById('feedback-val').innerHTML = "<span class='success'>Quiz beendet!</span>";
                document.getElementById('btn-next-val').style.display = 'inline-block';
                container.innerHTML = "";
                return;
            }
            let html = `<div style="margin-bottom:15px; font-size:1.2rem;">${q.q}</div>`;
            q.opts.forEach((opt, i) => {
                html += `<div class="quiz-option" onclick="checkVal(${i})">${opt}</div>`;
            });
            container.innerHTML = html;
        }
        function checkVal(i) {
            const q = valQs[curValIdx];
            const els = document.querySelectorAll('.quiz-option');
            const fb = document.getElementById('feedback-val');
            
            els.forEach((el, idx) => {
                if(idx === q.c) el.classList.add('selected-correct');
                if(idx === i && i !== q.c) el.classList.add('selected-wrong');
            });

            if(i === q.c) {
                fb.innerHTML = `<span class='success'>Richtig!</span><span class='explanation-text'>${q.expl}</span>`;
            } else {
                fb.innerHTML = `<span class='error'>Falsch.</span><span class='explanation-text'>${q.expl}</span>`;
            }
            
            fb.innerHTML += `<button class="btn btn-step" onclick="nextValStep()">N√§chste Frage</button>`;
        }
        
        function nextValStep() {
            document.getElementById('feedback-val').innerHTML = "";
            curValIdx++;
            showValQuiz();
        }

    </script>
</body>

</html>
